language: python

python:
- "3.6"

install:
- pip install websocket-client

script:
- python -m unittest discover
- git clone https://github.com/crossbario/autobahn-python.git
- cd autobahn-python/wstest && make downloads > /dev/null && make build > /dev/null && make versions && make setup > /dev/null
- python ../../autobahn-test.py &
- make test_server
after_success:
- chmod 0700 ./../../push.sh
- cd reports/servers
- "./../../../../push.sh"

deploy:
  provider: pypi
  user: "Kai-Bailey"
  password:
    secure: guSyRyd7L71uvzTFvbjZXFGJZH2wW4hFT2bD54oq31zkhbpd1sxBXayk9Po/ygQV48EUEdvgMcUTFLwtkAC/eS3FDygdfnLV6Evm0F7HupUUWeH9+Apw/rN3f6o9CkQ98L95Zy6kXibZZevUhllPClYuY8IShYAoGQtql4wgh1YfUtwvyC+r3AjTOKaxY7NCLOOj8ACIWDXGEPuocvSUwKN8S+UoOApTRN+Qx50suN/9JXLdRBRT9Izh2G0r8EGbpumqvP8hkNGEOj/5TEwxJyVmgq/UZOypv/x8BxS+SAkbnNwzVwVG1wDVXHYkLgbX8SSPiq8JYLjDaAIkhw4OGZ8eSJZPSkvPYehms7rbBBX7e9wMt9KmrbXNNa1fUw3FRDiUII/qDzA0ze7vNRcGoim9xn4jwaRTScOopH1eXN8VgUpXBhdKlb2Sbm6Z2dEFyTqwdbCL9XGdzqRve+rcW9fMR8d343+Fk7Fp1btSh3I6fcXtbjHGygv9t45ioAiwN7RjVB431khqr/lVMsY/YCfoqCqc9wqlFDheI7VNHXbDzk6mKb6ie0F3QEoCCMwKeDtRrtT7Re5I/PauBKSzjjwuN3602jBP9FjKNTNiFTSq+bvFeKj6Pp8nSKRIVxGGPO+wbkPEmtb6JanU4X+4uYlnNlZCPZL+Optco4v0QNk=

env:
  global:
    secure: 0XdxzwJM6vpwpQZpk4Xfw3IGzsZmTfil5DqorNWXrw+UkkaXM4e4SE9oBICNInsWi81p6keZGnUN6Ni59ILPT8GJW3iuZfJbFjx6QdkA9jonXxnksEoRK/IdDpeLHkRIIVW3LlDBYHJoZKoCbBIHHfjRCUP9NLW4wdbSGNKqMhxxV1I4hx93g2yDue7VbenpCs/xIEhceiyaJIGjuVCs7lnI3/G8EYRngf9Sqo0E+YqLuDwos9IEWpOwUvvpUxHzWy0vauk95rYgxXgT/DnpHAyk1NlknealIj+2y2lT2knOM8SPddqZ9khshFUK7ykyviNmHbHWyd6ab29+dh2wzH3aGIKRhieTnAp5j36yEIcOvLcfQH9WYQIel4vC/OYXNj96OWBq2wGZbXqUuQcdqjiIcZVLmw8KS3pwi85qDRl4RECcdnxJXTN9fvh/SHOmKX10jgHNT9TKiX0JXL/3uPkXRA2ixslMqlWZwyYhl4tsT4+r7iEICU6q2eTiuqA35Hugi3Xgl7jN1VmHEd+KvkzBrWoORDF6u9NfSRxuRJ8FNit4K0ZHmA6UhVc+7lqhjNTVWucxSkuuS7bG83S85LbbHGqVyf368Vi0x8mSyQ3yN4Vn62Y5Z41krkUhp4SawTbM0bg2EJ3Vg7if18XDJV4nX1+JmNx2aetMBhzeKj4=